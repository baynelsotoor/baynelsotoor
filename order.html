<div class="mb-4">
  <label class="block font-bold mb-2">اختر طريقة التوصيل</label>
  <select required name="طريقة التوصيل" id="deliveryMethod" class="w-full border rounded p-2" onchange="updateDeliveryOptions()">
    <option disabled selected value="">اختر طريقة التوصيل</option>
    <option value="metro">من أقرب محطة مترو (25 جنيه)</option>
    <option value="post">من مكتب بريد مصري</option>
    <option value="home">توصيل حتى باب البيت</option>
  </select>
</div>

<!-- ✅ أقرب محطة مترو -->
<div id="metro-section" class="mb-4 hidden">
  <label class="block font-bold mb-1">اختاري محطة المترو:</label>
  <select name="محطة المترو" class="w-full border rounded p-2">
    <option>المعادي</option>
    <option>شبرا</option>
    <option>المرج</option>
    <option>الجيزة</option>
  </select>
  <p class="text-sm mt-1 text-gray-600">يُضاف 25 جنيه على السعر الإجمالي</p>
</div>

<!-- ✅ البريد المصري -->
<div id="post-section" class="mb-4 hidden">
  <label class="block font-bold mb-1">نوع الشحن:</label>
  <div class="flex gap-4">
    <label><input type="radio" name="نوع الشحن" value="20" onclick="updatePostPrice(20)"> شحن عادي (20 جنيه)</label>
    <label><input type="radio" name="نوع الشحن" value="35" onclick="updatePostPrice(35)"> شحن سريع (35 جنيه)</label>
  </div>
  <label class="block font-bold mt-2">اسم مكتب البريد:</label>
  <input type="text" name="مكتب البريد" class="w-full border rounded p-2" placeholder="مثلاً: مكتب بريد المعادي">
  <p id="post-price" class="text-sm mt-1 text-gray-600">--</p>
</div>

<!-- ✅ باب البيت -->
<div id="home-section" class="mb-4 hidden">
  <label class="block font-bold mb-1">المحافظة:</label>
  <select id="governorate" name="المحافظة" class="w-full border rounded p-2" onchange="updateHomeDeliveryPrice()">
    <option value="">-- اختاري المحافظة --</option>
    <option value="cairo">القاهرة</option>
    <option value="giza">الجيزة</option>
    <option value="delta">الدلتا</option>
    <option value="upper_egypt">الصعيد</option>
  </select>
  <p id="home-price" class="text-sm mt-1 text-gray-600">--</p>
</div>

<!-- ✅ سكريبت توصيل -->
<script>
  const deliverySelect = document.getElementById("deliveryMethod");
  const metroSection = document.getElementById("metro-section");
  const postSection = document.getElementById("post-section");
  const homeSection = document.getElementById("home-section");
  const homePrice = document.getElementById("home-price");
  const postPrice = document.getElementById("post-price");

  let deliveryCost = 0;

  function updateDeliveryOptions() {
    metroSection.classList.add("hidden");
    postSection.classList.add("hidden");
    homeSection.classList.add("hidden");
    deliveryCost = 0;

    switch (deliverySelect.value) {
      case "metro":
        metroSection.classList.remove("hidden");
        deliveryCost = 25;
        break;
      case "post":
        postSection.classList.remove("hidden");
        break;
      case "home":
        homeSection.classList.remove("hidden");
        break;
    }
    updateTotal();
  }

  function updatePostPrice(cost) {
    deliveryCost = cost;
    postPrice.textContent = `السعر المضاف: ${cost} جنيه`;
    updateTotal();
  }

  function updateHomeDeliveryPrice() {
    const gov = document.getElementById("governorate").value;
    if (gov === "cairo" || gov === "giza") {
      deliveryCost = 50;
    } else if (gov === "delta") {
      deliveryCost = 65;
    } else if (gov === "upper_egypt") {
      deliveryCost = 75;
    } else {
      deliveryCost = 0;
    }
    homePrice.textContent = `السعر المضاف: ${deliveryCost} جنيه`;
    updateTotal();
  }

  function updateTotal() {
    let total = baseTotal;
    if (paymentSelect.value === "الدفع عند الاستلام" && !freeDelivery) total += 10;
    if (!freeDelivery) total += deliveryCost;
    totalElement.textContent = total;
    totalPriceInput.value = total;
  }
</script>
